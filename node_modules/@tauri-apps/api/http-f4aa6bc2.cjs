"use strict";var t,e=require("./tslib.es6-2b0ec40b.cjs"),r=require("./tauri-e0732f45.cjs");exports.ResponseType=void 0,(t=exports.ResponseType||(exports.ResponseType={}))[t.JSON=1]="JSON",t[t.Text=2]="Text",t[t.Binary=3]="Binary";var n=function(){function t(t,e){this.type=t,this.payload=e}return t.form=function(e){var r={};for(var n in e){var i=e[n],o=void 0;o="string"==typeof i?i:i instanceof Uint8Array||Array.isArray(i)?Array.from(i):"string"==typeof i.file?{file:i.file,mime:i.mime,fileName:i.fileName}:{file:Array.from(i.file),mime:i.mime,fileName:i.fileName},r[n]=o}return new t("Form",r)},t.json=function(e){return new t("Json",e)},t.text=function(e){return new t("Text",e)},t.bytes=function(e){return new t("Bytes",Array.from(e instanceof ArrayBuffer?new Uint8Array(e):e))},t}(),i=function(t){this.url=t.url,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.headers=t.headers,this.rawHeaders=t.rawHeaders,this.data=t.data},o=function(){function t(t){this.id=t}return t.prototype.drop=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(t){return[2,r.invokeTauriCommand({__tauriModule:"Http",message:{cmd:"dropClient",client:this.id}})]}))}))},t.prototype.request=function(t){return e.__awaiter(this,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){return(n=!t.responseType||t.responseType===exports.ResponseType.JSON)&&(t.responseType=exports.ResponseType.Text),[2,r.invokeTauriCommand({__tauriModule:"Http",message:{cmd:"httpRequest",client:this.id,options:t}}).then((function(t){var e=new i(t);if(n){try{e.data=JSON.parse(e.data)}catch(t){if(e.ok&&""===e.data)e.data={};else if(e.ok)throw Error("Failed to parse response `".concat(e.data,"` as JSON: ").concat(t,";\n              try setting the `responseType` option to `ResponseType.Text` or `ResponseType.Binary` if the API does not return a JSON response."))}return e}return e}))]}))}))},t.prototype.get=function(t,r){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(n){return[2,this.request(e._assign({method:"GET",url:t},r))]}))}))},t.prototype.post=function(t,r,n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(i){return[2,this.request(e._assign({method:"POST",url:t,body:r},n))]}))}))},t.prototype.put=function(t,r,n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(i){return[2,this.request(e._assign({method:"PUT",url:t,body:r},n))]}))}))},t.prototype.patch=function(t,r){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(n){return[2,this.request(e._assign({method:"PATCH",url:t},r))]}))}))},t.prototype.delete=function(t,r){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(n){return[2,this.request(e._assign({method:"DELETE",url:t},r))]}))}))},t}();function s(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,r.invokeTauriCommand({__tauriModule:"Http",message:{cmd:"createClient",options:t}}).then((function(t){return new o(t)}))]}))}))}var u=null;function a(t,r){var n;return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(i){switch(i.label){case 0:return null!==u?[3,2]:[4,s()];case 1:u=i.sent(),i.label=2;case 2:return[2,u.request(e._assign({url:t,method:null!==(n=null==r?void 0:r.method)&&void 0!==n?n:"GET"},r))]}}))}))}var p=Object.freeze({__proto__:null,getClient:s,fetch:a,Body:n,Client:o,Response:i,get ResponseType(){return exports.ResponseType}});exports.Body=n,exports.Client=o,exports.Response=i,exports.fetch=a,exports.getClient=s,exports.http=p;
